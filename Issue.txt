{"country":"US","notificationType":"Type_001","contentBody":{"PhysicalAccountNumber":"ACC123456","AccountCountry":"US","AccountCurrency":"USD","ParentVaultName":"Parent Vault","ParentVaultNumber":"PVN001","ChildVaultName":"Child Vault","ChildVaultNumber":"CVN001","ChildVaultLevel":"1","VANumber":"VA123456","VAName":"Virtual Account Name"},"contentType":"JSON","subject":"VAM - Subaccount Creation","refId":"REF12345","priority":null}


package com.scb.scroeconnect.emailworker.converter;

import com.fasterxml.jackson.databind.ObjectMapper;
import com.scb.scroeconnect.emailworker.dto.EmailPayloadDTO;
import jakarta.persistence.AttributeConverter;
import jakarta.persistence.Converter;

@Converter(autoApply = false)
public class EmailPayloadConverter implements AttributeConverter<EmailPayloadDTO, String> {

    private static final ObjectMapper OBJECT_MAPPER = new ObjectMapper();

    @Override
    public String convertToDatabaseColumn(EmailPayloadDTO emailPayloadDTO) {
        if (emailPayloadDTO == null) return null;
        try {
            return OBJECT_MAPPER.writeValueAsString(emailPayloadDTO);
        } catch (Exception e) {
            throw new IllegalArgumentException("Failed to serialize EmailPayloadDTO", e);
        }
    }

    @Override
    public EmailPayloadDTO convertToEntityAttribute(String emailData) {
        if (emailData == null) return null;
        try {
            return OBJECT_MAPPER.readValue(emailData, EmailPayloadDTO.class);
        } catch (Exception e) {
            throw new IllegalArgumentException("Failed to deserialize SolacePayloadDTO", e);
        }
    }
}

package com.scb.scroeconnect.emailworker.dto;

import java.nio.charset.StandardCharsets;
import java.util.Base64;
import java.util.Date;

public class EmailPayloadDTO {
    private String messageId;
    private String subject;
    private String contentBody;
    private String attachment;
    private String country;
    private String notificationType;
    private String contentType;
    private String priority;
    private Date initiatedTimestamp;

    public EmailPayloadDTO() {
    }

    public String getMessageId() {
        return messageId;
    }

    public void setMessageId(String messageId) {
        this.messageId = messageId;
    }

    public String getSubject() {
        return subject;
    }

    public void setSubject(String subject) {
        this.subject = subject;
    }

    public String getContentBody() {
        return contentBody;
    }

    public void setContentBody(String contentBody) {
        this.contentBody = Base64.getEncoder().encodeToString(contentBody.getBytes(StandardCharsets.UTF_8));
    }

    public String getAttachment() {
        return attachment;
    }

    public void setAttachment(String attachment) {
        this.attachment = attachment;
    }

    public Date getInitiatedTimestamp() {
        return initiatedTimestamp;
    }

    public void setInitiatedTimestamp(Date initiatedTimestamp) {
        this.initiatedTimestamp = initiatedTimestamp;
    }

    public String getCountry() {
        return country;
    }

    public void setCountry(String country) {
        this.country = country;
    }

    public String getNotificationType() {
        return notificationType;
    }

    public void setNotificationType(String notificationType) {
        this.notificationType = notificationType;
    }

    public String getContentType() {
        return contentType;
    }

    public void setContentType(String contentType) {
        this.contentType = contentType;
    }

    public String getPriority() {
        return priority;
    }

    public void setPriority(String priority) {
        this.priority = priority;
    }
}

Caused by: com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize value of type `java.lang.String` from Object value (token `JsonToken.START_OBJECT`)
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 1, column: 61] (through reference chain: com.scb.scroeconnect.emailworker.dto.EmailPayloadDTO["contentBody"])
	at com.fasterxml.jackson.databind.exc.MismatchedInputExcep
